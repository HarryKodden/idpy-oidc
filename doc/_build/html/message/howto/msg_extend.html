
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>How to extend message &#8212; idpyoidc 1.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="idpyoidc time utilities" href="../time_util.html" />
    <link rel="prev" title="How to use the idpyoidc Message class" href="message.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="how-to-extend-message">
<span id="oidcmsg-extend"></span><h1>How to extend message<a class="headerlink" href="#how-to-extend-message" title="Permalink to this headline">¶</a></h1>
<p>By extending I mean adding a new message class.
In most case starting with an existing class is probably the way to go.</p>
<p>Let’s assume that we want to add one claim to an ErrorResponse.
The claim are supposed to be <em>error_status</em> and the values of type integer.</p>
<p>The resulting class could look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">StatusErrorResponse</span><span class="p">(</span><span class="n">ErrorResponse</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Error response with status code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c_param</span> <span class="o">=</span> <span class="n">ErrorResponse</span><span class="o">.</span><span class="n">c_param</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">c_param</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">SINGLE_REQUIRED_INT</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">StatusErrorResponse</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="mi">200</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">600</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;status outside allowed value space&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Taken line by line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">StatusErrorResponse</span><span class="p">(</span><span class="n">ErrorResponse</span><span class="p">):</span>
</pre></div>
</div>
<p>StatusErrorResponse is a sub class of ErrorResponse:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c_param</span> <span class="o">=</span> <span class="n">ErrorResponse</span><span class="o">.</span><span class="n">c_param</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>All the claims that are connected to an ErrorResponse are here inherited
by the StatusErrorResponse class.</p>
<blockquote>
<div><p>c_param.update({“status”: SINGLE_REQUIRED_INT})</p>
</div></blockquote>
<p>Adds only one claim and that claim is required and of type integer.
There are a number of predefined specifications like this one ready
to be used.</p>
<ul class="simple">
<li><p>SINGLE_OPTIONAL_STRING</p></li>
<li><p>SINGLE_REQUIRED_STRING</p></li>
<li><p>SINGLE_OPTIONAL_INT</p></li>
<li><p>SINGLE_REQUIRED_INT</p></li>
<li><p>OPTIONAL_LIST_OF_STRINGS</p></li>
<li><p>REQUIRED_LIST_OF_STRINGS</p></li>
<li><p>OPTIONAL_LIST_OF_SP_SEP_STRINGS</p></li>
<li><p>REQUIRED_LIST_OF_SP_SEP_STRINGS</p></li>
<li><p>SINGLE_OPTIONAL_JSON</p></li>
<li><p>OPTIONAL_MESSAGE</p></li>
<li><p>REQUIRED_MESSAGE</p></li>
<li><p>OPTIONAL_LIST_OF_MESSAGES</p></li>
</ul>
<p>All these specifications follow the same pattern, being a tuple of these
parts:</p>
<ul class="simple">
<li><p>value type</p></li>
<li><p>required</p></li>
<li><p>serializer</p></li>
<li><p>deserializer</p></li>
<li><p>null allowed as value</p></li>
</ul>
<p>Next is the verify method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">StatusErrorResponse</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="mi">200</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">600</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;status outside allowed value space&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here running the super classes verify method first makes sense because
it means all claims will be checked to comply with the value specification
before we continue with the specific checks belonging to this class.
For instance in this case we can be sure the self[‘status’] has a value
and that the value is an integere. So we don’t have to check for that.</p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">idpyoidc</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction to IdPy-OIDC</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">idpyoidc classes and functions documentation!</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro.html">Introduction to message</a></li>
<li class="toctree-l2"><a class="reference internal" href="../message.html">Base protocol message</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oauth2.html">OAuth2 protocol messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../oidc.html">OpenID Connect protocol messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="message.html">How to use the idpyoidc Message class</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to extend message</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time_util.html">idpyoidc time utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../server/index.html">Welcome to Idpy OIDC OP Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client/index.html">Welcome to oidcrp’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client/index.html#indices-and-tables">Indices and tables</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">idpyoidc classes and functions documentation!</a><ul>
      <li>Previous: <a href="message.html" title="previous chapter">How to use the idpyoidc Message class</a></li>
      <li>Next: <a href="../time_util.html" title="next chapter">idpyoidc time utilities</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Roland Hedberg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/message/howto/msg_extend.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>