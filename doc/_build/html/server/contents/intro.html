
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>The OpenID Connect Provider &#8212; idpyoidc 1.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Setup" href="setup.html" />
    <link rel="prev" title="Welcome to Idpy OIDC OP Documentation" href="../index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="the-openid-connect-provider">
<h1>The OpenID Connect Provider<a class="headerlink" href="#the-openid-connect-provider" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This documentation are here to show you how to ‘build’ an OP using the
classes and functions provided by oidcop.</p>
<p>OAuth2 and thereby OpenID Connect (OIDC) are built on a request-response paradigm.
The RP issues a request and the OP returns a response.</p>
<p>The OIDC core standard defines a set of such request-responses.
This is a basic list of request-responses and the normal sequence in which they
occur:</p>
<ol class="arabic simple">
<li><p>Provider discovery (WebFinger)</p></li>
<li><p>Provider Info Discovery</p></li>
<li><p>Client registration</p></li>
<li><p>Authorization/Authentication</p></li>
<li><p>Access token</p></li>
<li><p>User info</p></li>
</ol>
<p>If you are just going to build a standard OP you only have to write the
configuration file and of course add authentication and user consent services.
If you want to add or replace functionality this document should be able to
tell you how.</p>
<p>Setting up an OP means making a number if decisions. Like, should the OP support
<a class="reference external" href="https://openid.net/specs/openid-connect-discovery-1_0.html#IssuerDiscovery">WebFinger</a> , <a class="reference external" href="https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfig">dynamic discovery</a> and/or <a class="reference external" href="https://openid.net/specs/openid-connect-registration-1_0.html">dynamic client registration</a> .</p>
<p>All these are services you can access at endpoints. The total set of endpoints
that this package supports are</p>
<ul class="simple">
<li><p>webfinger</p></li>
<li><p>provider_info</p></li>
<li><p>registration</p></li>
<li><p>authorization</p></li>
<li><p>token</p></li>
<li><p>refresh_token</p></li>
<li><p>userinfo</p></li>
<li><p>end_session</p></li>
</ul>
</div>
<div class="section" id="endpoint-layout">
<h2>Endpoint layout<a class="headerlink" href="#endpoint-layout" title="Permalink to this headline">¶</a></h2>
<p>When an endpoint receives a request it has to do a number of things:</p>
<ul class="simple">
<li><p>Verify that the client can issue the request (client authentication/authorization)</p></li>
<li><p>Verify that the request is correct and that it contains the necessary information.</p></li>
<li><p>Process the request, which includes applying server policies and gathering information.</p></li>
<li><p>Construct the response</p></li>
</ul>
<p>I should note at this point that this package is expected to work within the
confines of a web server framework such that the actual receiving and sending
of the HTTP messages are dealt with by the framework.</p>
<p>Based on the actions an endpoint has to perform a method call structure
has been constructed. It looks like this:</p>
<ol class="arabic">
<li><p>parse_request</p>
<blockquote>
<div><ul class="simple">
<li><p>client_authentication (*)</p></li>
<li><p>post_parse_request (*)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>process_request</p></li>
<li><p>do_response</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>response_info</dt><dd><ul>
<li><dl class="simple">
<dt>construct</dt><dd><ul>
<li><p>pre_construct (*)</p></li>
<li><p>_parse_args</p></li>
<li><p>post_construct (*)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>update_http_args</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>Steps marked with ‘*’ are places where extensions can be applied.</p>
<p><em>parse_request</em> expects as input the request itself in a number of formats and
also, if available, information about client authentication. The later is
normally the authorization element of the HTTP header.</p>
<p><em>do_response</em> returns a dictionary that can look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;response&#39;</span><span class="p">:</span>
    <span class="n">_response</span> <span class="k">as</span> <span class="n">a</span> <span class="n">string</span> <span class="ow">or</span> <span class="k">as</span> <span class="n">a</span> <span class="n">Message</span> <span class="n">instance_</span>
  <span class="s1">&#39;http_headers&#39;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Pragma&#39;</span><span class="p">,</span> <span class="s1">&#39;no-cache&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Cache-Control&#39;</span><span class="p">,</span> <span class="s1">&#39;no-store&#39;</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="s1">&#39;cookie&#39;</span><span class="p">:</span> <span class="n">_list</span> <span class="n">of</span> <span class="n">cookies_</span><span class="p">,</span>
  <span class="s1">&#39;response_placement&#39;</span><span class="p">:</span> <span class="s1">&#39;body&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple">
<dt>cookie</dt><dd><p>MAY be present</p>
</dd>
<dt>http_headers</dt><dd><p>MAY be present</p>
</dd>
<dt>http_response</dt><dd><p>Already clear and formatted HTTP response</p>
</dd>
<dt>response</dt><dd><p>MUST be present</p>
</dd>
<dt>response_placement</dt><dd><p>If absent defaults to the endpoints response_placement parameter value or
if that is also missing ‘url’</p>
</dd>
<dt>redirect_location</dt><dd><p>Where to send a redirect</p>
</dd>
</dl>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">idpyoidc</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction to idpyoidc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../message/index.html">idpyoidc classes and functions documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/message.html">How to use the idpyoidc Message class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howto/msg_extend.html">How to extend idpyoidc</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Welcome to Idpy OIDC OP Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">The OpenID Connect Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="conf.html">Configuration directives</a></li>
<li class="toctree-l2"><a class="reference internal" href="conf.html#token-exchange">Token exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="conf.html#clients">Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#configure-flask-rp">Configure flask-rp</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#refresh-token">Refresh token</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#introspection-endpoint">Introspection endpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#token-exchange">Token exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="session_management.html">Session Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="developers.html">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="clients.html">The clients database</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../client/index.html">Welcome to oidcrp’s documentation!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../client/index.html#indices-and-tables">Indices and tables</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Welcome to Idpy OIDC OP Documentation</a><ul>
      <li>Previous: <a href="../index.html" title="previous chapter">Welcome to Idpy OIDC OP Documentation</a></li>
      <li>Next: <a href="setup.html" title="next chapter">Setup</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Roland Hedberg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/server/contents/intro.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>